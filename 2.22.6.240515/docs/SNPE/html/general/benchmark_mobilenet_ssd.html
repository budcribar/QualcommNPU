

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>MobilenetSSD Benchmarking &mdash; Snapdragon Neural Processing Engine SDK</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom_css.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Inference Accuracy" href="accuracy.html" />
    <link rel="prev" title="Linting Profile" href="linting_profile.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Qualcomm® Neural Processing SDK
          

          
          </a>

          
            
            
              <div class="version">
                v2.22.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="revision_history.html">Revision History</a></li>
<li class="toctree-l1"><a class="reference internal" href="revision_history_windows.html">Revision History - Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="usergroup1.html">Network Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="usergroup5.html">Input Data and Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="usergroup6.html">Tutorials and Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="usergroup10.html">Benchmarking and Accuracy</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="benchmarking.html">Benchmarking</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">MobilenetSSD Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="accuracy.html">Inference Accuracy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="usergroup11.html">Debug Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="limitations.html">Limitations</a></li>
<li class="toctree-l1"><a class="reference internal" href="appx_ref.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Qualcomm® Neural Processing SDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="usergroup10.html">Benchmarking and Accuracy</a> &raquo;</li>
        
      <li>MobilenetSSD Benchmarking</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mobilenetssd-benchmarking">
<h1>MobilenetSSD Benchmarking<a class="headerlink" href="#mobilenetssd-benchmarking" title="Permalink to this heading">¶</a></h1>
<div class="ui-resizable side-nav-resizable docutils container" id="side-nav">
<div class="docutils container" id="nav-tree">
<div class="docutils container" id="nav-tree-contents">
</div>
</div>
</div>
<div class="docutils container" id="doc-content">
<div class="header docutils container">
</div>
<div class="contents docutils container">
<div class="textblock docutils container">
<div class="line-block">
<div class="line">Qualcomm® Neural Processing SDK supports a Tensorflow version of
MobilenetSSD model. See <a class="reference external" href="convert_mobilenetssd.html">Using
MobilenetSSD</a> for more details.</div>
<div class="line">Benchmarking Mobilenet SSD requires a few additions to the
benchmark JSON configuration file and also the data input
list.</div>
</div>
<p>Follow the <a class="reference external" href="benchmarking.html#benchmarking_overview">benchmark
overview</a> to
familiarize yourself with the benchmarking tool.</p>
<p>This tutorial assumes the following example files are created
in:</p>
<ul class="simple">
<li><p>/tmp/mobilenetssd.dlc - the converted neural network model
file</p></li>
<li><p>/tmp/mobilenetssd.json - benchmark configuration file</p></li>
<li><p>/tmp/imagelist.txt - list of raw image paths (one per line)</p></li>
<li><p>/tmp/images.rawtensor - directory containing images specified in
imagelist.txt above</p></li>
</ul>
<p>The Mobilenet SSD benchmark configuration file contains the
same entries as defined in <a class="reference external" href="benchmarking.html#benchmarking_overview">benchmark
overview</a> with one
additional parameter. Create or edit the /tmp/mobilenetssd.json
file and add a line to indicate use of the <strong>CpuFallback</strong>
option. This option is required to enable the Mobilenet SSD
benchmark to execute properly.</p>
<p>The JSON file should look similar to this:</p>
<div class="highlight-fragment notranslate"><div class="highlight"><pre><span></span>{
  &quot;Name&quot;:&quot;mobilenet_ssd&quot;,
  &quot;HostRootPath&quot;: &quot;mobilenet_ssd&quot;,
  &quot;HostResultsDir&quot;:&quot;mobilenet_ssd/results&quot;,
  &quot;DevicePath&quot;:&quot;/data/local/tmp/snpebm&quot;,
  &quot;Devices&quot;:[&quot;454d40f3&quot;],
  &quot;Runs&quot;:2,

  &quot;Model&quot;: {
      &quot;Name&quot;: &quot;mobilenet_ssd&quot;,
      &quot;Dlc&quot;: &quot;/tmp/mobilenet_ssd.dlc&quot;,
      &quot;InputList&quot;: &quot;/tmp/imagelist.txt&quot;,
      &quot;Data&quot;: [
          &quot;/tmp/images&quot;
      ]
  },

  &quot;Runtimes&quot;:[&quot;GPU&quot;],
  &quot;Measurements&quot;: [&quot;timing&quot;],
  &quot;CpuFallback&quot;: true,
  &quot;BufferTypes&quot;: [&quot;ub_float&quot;,&quot;ub_tf8&quot;],
  &quot;ProfilingLevel&quot;: &quot;detailed&quot;
}
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>Tensorflow Mobilenet SSD model</strong></div>
<div class="line">Tensorflow Mobilenet SSD has more than one output layer. To
accurately represent the outputs in the benchmark run the
additional outputs need to be specified as part of
<code class="docutils literal notranslate"><span class="pre">/tmp/imagelist.txt</span></code>.</div>
</div>
<p>The output layers for the model are:</p>
<ul class="simple">
<li><p>Postprocessor/BatchMultiClassNonMaxSuppression</p></li>
<li><p>add_6</p></li>
</ul>
<p>Add the output layer names on the first line of the image list
file (<code class="docutils literal notranslate"><span class="pre">/tmp/imagelist.txt</span></code>) starting with ‘#’ and separating
each layer name with a space. For example,</p>
<div class="highlight-fragment notranslate"><div class="highlight"><pre><span></span>#Postprocessor/BatchMultiClassNonMaxSuppression add_6
tmp/0#.rawtensor
tmp/1#.rawtensor
</pre></div>
</div>
<p>The image rawfiles 0#.rawtensor, 1#.rawtensor are in (<code class="docutils literal notranslate"><span class="pre">/tmp</span></code>), etc</p>
<p><strong>NOTE:</strong> If the model is retrained and the output layers
change, the first line in imagelist.txt must be updated to
reflect these changes.</p>
<div class="line-block">
<div class="line"><strong>Running benchmark</strong></div>
<div class="line">Run the benchmark via</div>
</div>
<div class="highlight-fragment notranslate"><div class="highlight"><pre><span></span>python3 snpe_bench.py -c /tmp/mobilenetssd.json -a
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>Viewing the Results (csv File or json File)</strong></div>
<div class="line">All results are stored in the “HostResultDir” that is
specified in the configuration json file. The benchmark
creates time-stamped directories for each benchmark run. All
timing results are stored in microseconds.</div>
</div>
<p>For your convenience, a “latest_results” link is created that
always points to the most recent run.</p>
<div class="highlight-fragment notranslate"><div class="highlight"><pre><span></span># In mobilenetssd.json, &quot;HostResultDir&quot; is set to &quot;mobilenet_ssd/results&quot;
cd $SNPE_ROOT/benchmarks/SNPE/mobilenet_ssd/results
# Notice the time stamped directories and the &quot;latest_results&quot; link.
cd $SNPE_ROOT/benchmarks/SNPE/mobilenet_ssd/results/latest_results
# Notice the .csv file, open this file in a csv viewer (Excel, LibreOffice Calc)
# Notice the .json file, open the file with any text editor
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>CSV Benchmark Results File</strong></div>
<div class="line">The CSV file contains results similar to the example below.
Some measurements may not appear in the CSV file. To get all
timing information, the profiling level needs to be set to
<strong>detailed</strong>. By default, the profiling level is basic. Note
that colored headings have been added for clarity.</div>
</div>
<div class="docutils container">
<div class="figure align-default">
<img alt="../images/mobilenet_ssd_csv_results.png" src="../images/mobilenet_ssd_csv_results.png" />
</div>
</div>
<p>A more detailed description of the CSV result file can be found
in <a class="reference external" href="benchmarking.html#benchmarking_overview">benchmark
overview</a>.</p>
<p>Comparing the <strong>Total Inference Time</strong> and <strong>Forward
Propagate</strong> rows, we find that GPU and DSP inference times are
faster than the CPU by about <strong>17~39x</strong>. Using GPU and DSP for
MobilenetSSD inferencing may achieve higher performance.</p>
<div class="line-block">
<div class="line"><strong>JSON Benchmark Results File</strong></div>
<div class="line">The benchmark results published in the CSV file can also be
made available in JSON format. Run the benchmark via</div>
</div>
<div class="highlight-fragment notranslate"><div class="highlight"><pre><span></span>python3 snpe_bench.py -c /tmp/mobilenetssd.json -a --generate_json
</pre></div>
</div>
<p>The contents are the same as in the CSV file, structured as
key-value pairs, and will help parsing the results in a simple
and efficient manner. The JSON file contains results similar to
the example below.</p>
<div class="docutils container">
<div class="figure align-default">
<img alt="../images/mobilenet_ssd_json_results.png" src="../images/mobilenet_ssd_json_results.png" />
</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="accuracy.html" class="btn btn-neutral float-right" title="Inference Accuracy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="linting_profile.html" class="btn btn-neutral float-left" title="Linting Profile" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020-2023, Qualcomm Technologies, Inc..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>